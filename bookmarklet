javascript:(()=>{if(window.__atomiWatcherInjected)return;window.__atomiWatcherInjected=1;const seenAnswers=new Set();let refText=null;let autoAnswering=false;const updateQuestionProgress=()=>{const t=[...document.querySelectorAll("p")].find(p=>/of \d+/.test(p.textContent?.trim()))?.textContent;if(!t)return;const l=document.querySelector("#question-progress-label");if(l)l.textContent="ðŸ“˜ "+t.trim();};const run=()=>{const d=window.__APOLLO_CLIENT__?.cache?.data?.data;if(!d)return;const o=Object.entries(d).filter(([k])=>k.startsWith("MultipleChoiceQuestionOption")).reduce((m,[,v])=>(m[v.id]=v,m),{});const q=Object.entries(d).filter(([,v])=>v.__typename==="MultipleChoiceQuestion").map(([,v])=>v);q.forEach(q=>{if(!Array.isArray(q.options))return;const c=q.options.map(r=>o[r.__ref?.split(":")[1]]).find(opt=>opt?.isCorrect);if(!c?.label)return;const t=c.label.trim();const b=[...document.querySelectorAll("div")].filter(div=>div.textContent?.includes(q.prompt.slice(0,15)));b.forEach(b=>{b.querySelectorAll("label,.option,.choice,button,span,li,div").forEach(e=>{if(e.textContent?.trim()===t&&!e.dataset._highlighted){e.dataset._highlighted="true";Object.assign(e.style,{backgroundColor:"#d4edda",border:"2px solid #28a745",borderRadius:"5px",padding:"6px",fontWeight:"bold",boxShadow:"0 0 5px #28a745"})}})})});document.querySelectorAll(".drag-badge").forEach(e=>e.remove());const dqs=Object.entries(d).filter(([,v])=>v.__typename==="DragAndDropQuestion").map(([,v])=>v);const seenLabels=new Set();dqs.forEach(q=>{if(!Array.isArray(q.answers))return;const a=q.answers.filter(a=>a.__typename==="DragAndDropQuestionCorrectAnswer").sort((a,b)=>a.position-b.position);a.forEach((ans,i)=>{const l=ans.label?.trim();if(!l||seenLabels.has(l))return;const els=[...document.querySelectorAll("div,span,li,button,tr,td")].filter(e=>e.textContent?.trim()===l&&!e.querySelector(".drag-badge")&&getComputedStyle(e).display!=="none"&&e.offsetHeight>10&&e.offsetWidth<500);if(els.length){const e=els[0];seenLabels.add(l);const b=document.createElement("div");b.className="drag-badge";b.innerText=%60#${i+1}%60;Object.assign(b.style,{position:"absolute",top:"4px",right:"4px",background:"#007bff",color:"#fff",padding:"2px 6px",fontSize:"12px",borderRadius:"12px",fontWeight:"bold",zIndex:9999});e.style.position="relative";e.appendChild(b)}})});const sm=Object.values(d).filter(v=>v.__typename==="SelfMarkedLiteQuestion");const extractText=(txt)=>{const match=txt.match(/(\*{0,2})?(Sample Answer|Reference Answer|Answers could include:)(\*{0,2})?/i);if(!match)return txt.trim();const idx=txt.indexOf(match[0]);return txt.slice(idx+match[0].length).replace(/\*\*/g,"").trim();};const refMap=sm.map(q=>{const parsed=extractText(q.referenceAnswer);return parsed||q.referenceAnswer?.trim();}).filter(Boolean);sm.forEach(q=>{if(seenAnswers.has(q.id)||!q.referenceAnswer)return;refText=extractText(q.referenceAnswer);seenAnswers.add(q.id);});if(!document.querySelector("#atomi-drag-ui")){const container=document.createElement("div");container.id="atomi-drag-ui";Object.assign(container.style,{position:"fixed",top:"80px",left:"20px",zIndex:9999,background:"#f4f4f4",border:"2px solid #ccc",borderRadius:"10px",padding:"10px",boxShadow:"0 0 10px rgba(0,0,0,0.2)",cursor:"move",display:"flex",flexDirection:"column",gap:"6px"});const header=document.createElement("div");header.id="atomi-drag-header";header.innerText="âš™%EF%B8%8F Atomi Tools";header.style.fontWeight="bold";container.appendChild(header);const copyRefWrap=document.createElement("div");Object.assign(copyRefWrap.style,{display:"flex",alignItems:"center"});const copyBtn=document.createElement("button");copyBtn.id="copy-ref-btn";copyBtn.innerText="Copy Reference";Object.assign(copyBtn.style,{padding:"6px 10px",borderRadius:"6px",border:"none",background:"#007bff",color:"white"});copyRefWrap.appendChild(copyBtn);const sel=document.createElement("select");sel.id="copy-ref-select";Object.assign(sel.style,{marginLeft:"6px",padding:"2px",fontSize:"12px",borderRadius:"4px"});refMap.forEach((_,i)=>{const opt=document.createElement("option");opt.value=i;opt.innerText=i+1;sel.appendChild(opt);});copyRefWrap.appendChild(sel);container.appendChild(copyRefWrap);const exactAnswers=Object.entries(d).filter(([k,v])=>k.startsWith("ExactAnswerQuestionAnswer:")&&v.label);const exactLabels=exactAnswers.map(([,v])=>v.label.trim()).filter(Boolean);if(exactLabels.length){const exactWrap=document.createElement("div");Object.assign(exactWrap.style,{display:"flex",alignItems:"center"});const copyBtnExact=document.createElement("button");copyBtnExact.innerText="Copy Exact Answer";Object.assign(copyBtnExact.style,{padding:"6px 10px",borderRadius:"6px",border:"none",background:"#6f42c1",color:"white"});const exactSelect=document.createElement("select");exactSelect.id="exact-answer-select";Object.assign(exactSelect.style,{marginLeft:"6px",padding:"2px",fontSize:"12px",borderRadius:"4px"});exactLabels.forEach((label,i)=>{const opt=document.createElement("option");opt.value=i;opt.innerText=%60${i+1}: ${label.slice(0,30)}%60;exactSelect.appendChild(opt);});copyBtnExact.onclick=()=>{const idx=parseInt(exactSelect.value);const txt=exactLabels[idx];navigator.clipboard.writeText(txt).then(()=>{copyBtnExact.innerText="âœ… Copied!";setTimeout(()=>{copyBtnExact.innerText="Copy Exact Answer";},2000);});};exactWrap.appendChild(copyBtnExact);exactWrap.appendChild(exactSelect);container.appendChild(exactWrap);}copyBtn.onclick=()=>{const selected=parseInt(document.querySelector("#copy-ref-select").value);const txt=refMap[selected];if(txt)navigator.clipboard.writeText(txt).then(()=>{copyBtn.innerText="ðŸ“‹ Copied!";setTimeout(()=>{copyBtn.innerText="Copy Reference";},2000);});else alert("No reference found.");};const autoBtn=document.createElement("button");autoBtn.id="auto-answer-btn";autoBtn.innerText="Auto Answer: OFF";Object.assign(autoBtn.style,{padding:"6px 10px",borderRadius:"6px",border:"none",background:"#ffc107",color:"black"});autoBtn.onclick=()=>{autoAnswering=!autoAnswering;autoBtn.innerText=autoAnswering?"Auto Answer: ON":"Auto Answer: OFF";autoBtn.style.background=autoAnswering?"#007bff":"#ffc107";updateQuestionProgress();};container.appendChild(autoBtn);const darkBtn=document.createElement("button");darkBtn.id="darkmode-toggle";darkBtn.innerText="Dark Mode: OFF";Object.assign(darkBtn.style,{padding:"6px 10px",borderRadius:"6px",border:"none",background:"#343a40",color:"white"});darkBtn.onclick=()=>{if(!window.DarkReader){const s=document.createElement("script");s.src="https://unpkg.com/darkreader@4.9.58/darkreader.js";s.onload=()=>darkBtn.click();document.head.appendChild(s);return}if(localStorage.getItem("darkModeEnabled")==="true"){DarkReader.disable();localStorage.setItem("darkModeEnabled","false");darkBtn.innerText="Dark Mode: OFF";}else{DarkReader.enable();localStorage.setItem("darkModeEnabled","true");darkBtn.innerText="Dark Mode: ON";}};container.appendChild(darkBtn);const qLabel=document.createElement("div");qLabel.id="question-progress-label";qLabel.innerText="ðŸ“˜ Question: 0";Object.assign(qLabel.style,{fontSize:"12px",fontWeight:"bold"});container.appendChild(qLabel);document.body.appendChild(container);let offsetX,offsetY,dragging=false;header.addEventListener("mousedown",e=>{dragging=true;offsetX=e.clientX-container.offsetLeft;offsetY=e.clientY-container.offsetTop;document.body.style.userSelect="none";});document.addEventListener("mouseup",()=>{dragging=false;document.body.style.userSelect="auto";});document.addEventListener("mousemove",e=>{if(!dragging)return;container.style.left=(e.clientX-offsetX)+"px";container.style.top=(e.clientY-offsetY)+"px";});}if(autoAnswering){const clickable=[...document.querySelectorAll("label,.option,.choice,button,span,li,div")].filter(e=>e.dataset._highlighted&&!e.dataset._autoClicked);let i=0;const clickNext=()=>{if(i>=clickable.length)return;const el=clickable[i];el.dataset._autoClicked="true";el.click?.();setTimeout(()=>{const checkBtn=[...document.querySelectorAll("button")].find(b=>b.textContent.trim()==="Check Answer");checkBtn?.click?.();setTimeout(()=>{const nextBtn=[...document.querySelectorAll("button,span")].find(b=>b.textContent.trim()==="Next");nextBtn?.click?.();},400);},300);i++;setTimeout(clickNext,800)};clickNext();}updateQuestionProgress();};run();const obs=new MutationObserver(()=>setTimeout(()=>{run();updateQuestionProgress();},150));obs.observe(document.body,{childList:true,subtree:true});})();